# 📄 PDF RAG 匯入功能完整指南

## 🎉 功能已成功實現！

您的 D&D SRD PDF 檔案已成功匯入到 RAG 系統中，現在可以進行智能查詢了。

## 📊 匯入結果

- **📄 檔案**: SRD_CC_v5.2.1.pdf (5.75 MB)
- **🏷️ 命名空間**: `dnd_srd`
- **📝 文本片段**: 2,305 個
- **✅ 狀態**: 匯入成功

## 🔍 如何使用 RAG 查詢

### 方法一：使用 Web 界面（推薦）

1. **訪問前端**: http://localhost:8080
2. **找到右側的「🔍 RAG 知識查詢」區域**
3. **設置參數**:
   - 命名空間：輸入 `dnd_srd`
   - 查詢問題：例如「什麼是戰士職業？」或「龍的種類有哪些？」
   - 返回結果數量：建議 3-5 個
4. **點擊「🔍 搜尋答案」**

### 方法二：使用 API 直接查詢

```bash
# PowerShell 範例
$body = @{
    namespace = "dnd_srd"
    question = "什麼是法師職業？"
    top_k = 3
} | ConvertTo-Json

$response = Invoke-RestMethod -Uri "http://localhost:8000/rag/query" -Method POST -Body $body -ContentType "application/json"
$response.answer
```

## 📤 如何上傳更多 PDF 檔案

### 使用 Web 界面上傳

1. **訪問**: http://localhost:8080
2. **找到右側的「📄 PDF 檔案匯入」區域**
3. **設置參數**:
   - 命名空間：例如 `my_documents`（每個主題建議使用不同的命名空間）
   - 選擇 PDF 檔案：點擊「選擇檔案」並選擇您的 PDF
4. **點擊「📤 上傳 PDF」**

### 支援的檔案格式
- ✅ PDF 檔案 (.pdf)
- 📝 自動文本提取和分塊處理
- 🔍 智能重疊保持上下文連續性

## 🎯 查詢範例

以下是一些您可以嘗試的 D&D SRD 查詢：

### 🗡️ 職業相關
- "戰士職業有什麼特殊能力？"
- "法師可以學會哪些咒語？"
- "盜賊的偷襲如何運作？"

### 🐉 怪物相關
- "龍的種類有哪些？"
- "獸人的屬性是什麼？"
- "不死生物有什麼特徵？"

### ⚔️ 戰鬥規則
- "如何計算傷害擲骰？"
- "優勢和劣勢是什麼？"
- "法術攻擊如何運作？"

### 🛡️ 裝備相關
- "魔法物品有哪些類型？"
- "武器的屬性有哪些？"
- "護甲如何影響 AC？"

## 🔧 技術細節

### PDF 處理流程
1. **文本提取**: 使用 PyPDF2 逐頁提取文本
2. **智能分塊**: 將長文本分割成 800 字符的片段，保持 150 字符重疊
3. **向量化**: 使用 nomic-embed-text 模型生成嵌入向量
4. **存儲**: 保存到本地 JSON 文件，支持快速檢索

### 查詢流程
1. **問題向量化**: 將用戶問題轉換為嵌入向量
2. **相似度匹配**: 使用餘弦相似度找到最相關的文本片段
3. **上下文組合**: 組合相關片段作為上下文
4. **AI 生成回答**: 使用 qwen2.5:3b 模型基於上下文生成回答

## 🛠️ 故障排除

### 常見問題

**Q: PDF 上傳失敗**
- 檢查檔案是否為 PDF 格式
- 確認檔案大小不超過 50MB
- 檢查網路連接

**Q: 查詢沒有結果**
- 確認命名空間名稱正確
- 嘗試使用不同的關鍵詞
- 檢查 PDF 是否成功匯入

**Q: 回答不准確**
- 增加 top_k 參數以獲取更多上下文
- 使用更具體的問題
- 確認 PDF 內容包含相關資訊

## 🎊 使用建議

1. **命名空間管理**: 為不同主題的文檔使用不同的命名空間
2. **問題精確性**: 提出具體、明確的問題以獲得更好的回答
3. **文檔品質**: 確保 PDF 文本清晰，避免掃描版本的模糊文字
4. **批量上傳**: 可以上傳多個相關的 PDF 到同一個命名空間

**🎲 現在您可以開始探索 D&D SRD 的豐富內容了！**